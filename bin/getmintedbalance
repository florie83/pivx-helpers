#!/bin/bash

# It tells you how many coins were minted since the last time you checked.
# If you immediately check again the result will be zero until new coins are minted.

# Example output:
#
#   last: 1
#current: 3.4
# minted: 2.4

set -e

balanceFile=~/.pivx/balance

function readBalanceFile() {
  local default=$1

  if [ ! -f $balanceFile ]; then
    echo $default > $balanceFile
  fi

  head -n 1 $balanceFile
}

function updateBalanceFile() {
  echo $1 > $balanceFile; 
}

curr=`pivx-cli getbalance`;
prev=`readBalanceFile $curr`;
new=$(bc <<< $curr-$prev);

updateBalanceFile $curr

echo '   last balance: '$prev;
echo 'current balance: '$curr;
echo "recently minted: $new";

exit 0
